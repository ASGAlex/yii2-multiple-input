!function(t){t.fn.multipleInput=function(e){return a[e]?a[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.multipleInput"),!1):a.init.apply(this,arguments)};var e={afterInit:"afterInit",afterAddRow:"afterAddRow",beforeDeleteRow:"beforeDeleteRow",afterDeleteRow:"afterDeleteRow"},i={id:null,template:null,jsTemplates:[],limit:1,min:1,attributeOptions:{},indexPlaceholder:"multiple_index",uniqueHash:null},n={enableAjaxValidation:!1,validateOnBlur:!1,validateOnChange:!1,validateOnType:!1},l=!1,a={init:function(a){var p=t.extend(!0,{},i,a||{}),f=t("#"+p.id),d=f.closest("form"),c=this.selector.replace("#","");f.data("multipleInput",{settings:p,currentIndex:0,attributeDefaults:{}}),f.on("click.multipleInput",".js-input-remove",function(e){e.stopPropagation(),u(t(this))}),f.on("click.multipleInput",".js-input-plus",function(e){e.stopPropagation(),r(t(this))});var m=0,v=t.Event(e.afterInit),h=setInterval(function(){if("object"==typeof d.data("yiiActiveForm")){var e=d.yiiActiveForm("find",c),i=[];"object"==typeof e&&(t.each(e,function(t,e){-1==["id","input","container"].indexOf(t)&&(i[t]=e)}),d.yiiActiveForm("remove",c));var a=t.extend({},n,p.attributeOptions);t.each(a,function(t,e){"undefined"==typeof i[t]&&(i[t]=e)}),f.data("multipleInput").attributeDefaults=i,f.find(".multiple-input-list").find("input, select, textarea").each(function(){o(t(this))}),f.data("multipleInput").currentIndex=s(f),l=!0,clearInterval(h),f.trigger(v)}else m++;m>10&&(f.data("multipleInput").currentIndex=s(f),l=!1,clearInterval(h),f.trigger(v))},100)},add:function(e){r(t(this),e)},remove:function(e){var i=null;i=e?t(this).find(".js-input-remove:eq("+e+")"):t(this).find(".js-input-remove").last(),u(i)},clear:function(){t(".js-input-remove").each(function(){u(t(this))})}},r=function(i,n){var a=t(i).closest(".multiple-input").first(),r=a.data("multipleInput"),u=r.settings,p=u.template,s=a.find(".multiple-input-list."+u.uniqueHash).first(),d=a.find(".multiple-input-list__item."+u.uniqueHash).length;if(!(null!=u.limit&&d>=u.limit)){if(p=p.replaceAll("{"+u.indexPlaceholder+"}",r.currentIndex),t(p).hide().appendTo(s).fadeIn(300),n instanceof Object){var c=[];for(var m in n)n.hasOwnProperty(m)&&c.push(n[m]);n=c}var v;for(var h in u.jsTemplates)v=u.jsTemplates[h].replaceAll("{"+u.indexPlaceholder+"}",r.currentIndex).replaceAll("%7B"+u.indexPlaceholder+"%7D",r.currentIndex),window.eval(v);var I=0;t(p).find("input, select, textarea").each(function(){var e=t(this),i=e.get(0).tagName,a=f(e),r=t("#"+a);if(n){var u=n[I];if("INPUT"==i||"TEXTAREA"==i)r.val(u);else if("SELECT"==i)if(u&&-1!=u.indexOf("option"))r.append(u);else{var p=r.find('option[value="'+u+'"]');p.length&&r.val(u)}}l&&o(e),I++}),a.data("multipleInput").currentIndex++;var g=t.Event(e.afterAddRow);a.trigger(g)}},u=function(i){var n=i.closest(".multiple-input").first(),a=i.closest(".multiple-input-list__item"),r=n.data("multipleInput"),u=r.settings,o=t(".multiple-input-list__item."+u.uniqueHash).length;if(o>u.min){var f=t.Event(e.beforeDeleteRow);if(n.trigger(f,[a]),f.result===!1)return;l&&a.find("input, select, textarea").each(function(){p(t(this))}),a.fadeOut(300,function(){t(this).remove(),f=t.Event(e.afterDeleteRow),n.trigger(f)})}},o=function(e){var i=f(e);if(null!==i){var n=t("#"+i),l=n.closest(".multiple-input").first(),a=n.closest("form");if(0!=l.length&&"undefined"==typeof a.yiiActiveForm("find",i)){var r=l.data("multipleInput");a.yiiActiveForm("add",t.extend({},r.attributeDefaults,{id:i,input:"#"+i,container:".field-"+i}))}}},p=function(){var e=f(t(this));if(null!==e){var i=t("#"+e).closest("form");0!==i.length&&i.yiiActiveForm("remove",e)}},f=function(t){var e=t.attr("id");return"undefined"==typeof e&&(e=t.data("id")),"undefined"==typeof e?null:e},s=function(t){return"object"!=typeof t.data("multipleInput")?0:t.find(".multiple-input-list__item."+t.data("multipleInput").settings.uniqueHash).length};String.prototype.replaceAll=function(t,e){return this.split(t).join(e)}}(window.jQuery);