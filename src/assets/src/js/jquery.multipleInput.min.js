!function(t){t.fn.multipleInput=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(t.error("Method "+e+" does not exist on jQuery.multipleInput"),!1):i.init.apply(this,arguments)};var e={id:null,template:null,jsTemplates:[],btnAction:null,btnType:null,limit:1,replacement:[]},i={init:function(n){var l=t.extend({},e,n||{}),u=t("#"+l.id),r=u.closest("form"),a=this.selector.replace("#","");u.data("multipleInput",{settings:l,currentIndex:0,attributeDefaults:{}}),t(document).on("click.multipleInput","#"+l.id+" .js-input-remove",function(t){t.preventDefault(),i.removeInput.apply(this)}),t(document).on("click.multipleInput","#"+l.id+" .js-input-plus",function(t){t.preventDefault(),i.addInput.apply(this)});var p=setInterval(function(){if("object"==typeof r.data("yiiActiveForm")){var e=r.yiiActiveForm("find",a);"object"==typeof e&&(t.each(e,function(t,e){-1==["id","input","container"].indexOf(t)&&(u.data("multipleInput").attributeDefaults[t]=e)}),r.yiiActiveForm("remove",a)),u.find(".multiple-input-list").find("input, select, textarea").each(function(){i.addAttribute.apply(this)}),u.data("multipleInput").currentIndex=u.find(".multiple-input-list__item").length,t("[data-selected-option]").each(function(e,i){var n=t(i);n.val(n.data("selected-option")).removeAttr("data-selected-option")}),clearInterval(p)}},100);u.trigger("init")},addInput:function(){var e=t(this).closest(".multiple-input").first(),n=e.data("multipleInput"),l=n.settings,u=l.template,r=e.find(".multiple-input-list").first(),a=e.find(".multiple-input-list__item").length,p=l.replacement||[];if(!(null!=l.limit&&a>=l.limit)){var o=["{multiple-index}","{multiple-btn-action}","{multiple-btn-type}","{multiple-value}"],c=[n.currentIndex,l.btnAction,l.btnType,""];for(var s in o)u=u.replaceAll(o[s],c[s]);for(var d in p)u=u.replaceAll("{"+d+"}",p[d]);t(u).hide().appendTo(r).fadeIn(300),t(u).find("input, select, textarea").each(function(){i.addAttribute.apply(this)});var m;for(s in l.jsTemplates)m=l.jsTemplates[s].replaceAll("{multiple-index}",n.currentIndex),window.eval(m);e.data("multipleInput").currentIndex++,e.trigger("addNewRow")}},removeInput:function(){var e=t(this).closest(".multiple-input").first(),n=t(this).closest(".multiple-input-list__item");n.find("input, select, textarea").each(function(){i.removeAttribute.apply(this)}),n.fadeOut(300,function(){t(this).remove()}),e.trigger("removeRow")},addAttribute:function(){var e=t(this).attr("id"),i=t("#"+t(this).attr("id")),n=i.closest(".multiple-input").first(),l=i.closest("form");l.yiiActiveForm("add",t.extend(n.data("multipleInput").attributeDefaults,{id:e,input:"#"+e,container:".field-"+e}))},removeAttribute:function(){var e=t(this).attr("id"),i=t("#"+t(this).attr("id")).closest("form");i.yiiActiveForm("remove",e)}};String.prototype.replaceAll=function(t,e){return this.split(t).join(e)}}(window.jQuery);